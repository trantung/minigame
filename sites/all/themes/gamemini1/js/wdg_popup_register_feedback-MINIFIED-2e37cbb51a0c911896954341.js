SpilGames("spilgames.import",{name:"PopupRegisterFeedbackHelper",deps:["DOMSelect"],module:function(l){function a(){var a=!1,d=l.get(e);d&&(a="true"===d.getAttribute("data-on-social-game-page"));return a}var e;return{init:function(a){e=a},whichPopupToShow:function(g,d){var c;switch(g){case "link":a()?c="link-social":(c=(d||"").split("/").pop(),c="dummy_small.png"!==c&&"dummy_small.gif"!==c?"link-regular":"link-regular-without-avatar");break;default:case "register":c=a()?"registration-social":"registration-regular"}return c}}}});SpilGames("spilgames.import",{name:"PopupRegisterFeedback",deps:["SWPEvent","SWPUtils","Utils","DOMSelect","DOMEvent"],module:function(l,a,e,g,d){var c,m,r=function(f){d.add(c,"click",function(b){a.hasClass(b.target||b.srcElement,f.closeButton)&&k()})},k=function(){l.emit("popup.registration.feedback.closed");a.addClass(m,"hidden")},h=function(){var f=g.getAll(c+" > article");e.each(f,function(b,c,f){a.hasClass(b,"hidden")||a.addClass(b,"hidden")})};return{init:function(a){c=a.container;m=g.get(c);
r(a.elements)},open:function(f,b){if(f){h();var n,d,t,e;if(b){t=g.get(c+" > #"+f);e=t.innerHTML;for(n in b)b.hasOwnProperty(n)&&(d=new RegExp("\\["+n+"\\]","g"),e=e.replace(d,b[n]));t.innerHTML=e}(n=g.get(c+" > #"+f))&&a.removeClass(n,"hidden");a.removeClass(m,"hidden")}},close:k}}});SpilGames({name:"wdg_popup_register_feedback",waiton:"spilgames.loaded"},"SWPUtils SWP SWPEvent JSLib DOMSelect PopupRegisterFeedback PopupRegisterFeedbackHelper Portal".split(" "),function(l,a,e,g,d,c,m,r){function k(a){g("api.user.get",function(c){a(c)})}a.init("popup_register_feedback");var h=a.getProperty("show_popup_contents"),f=function(){var a=!1;return function(){a||(m.init(".wdg_popup_register_feedback"),c.init({container:".wdg_popup_register_feedback",elements:{closeButton:"popup-register-feedback-close"}}),
a=!0)}}();a.System.init(function(b){var e,d,g,l=b.body&&b.body.type,u=b.body&&b.body.username;switch(b.name){case "popup.register.feedback":var p=function(){f();d={username:u||""};g="";k(function(b){if(!b.error&&b.userInfo){d.username=b.userInfo.name||d.username;g=b.userInfo.avatarUrl;b=b.userInfo.guid;r.get("siteid");var f=document.getElementById("wdg_popup_register_feedback_version"),h=document.getElementById("wdg_prf_campaignid"),k=document.getElementById("wdg_prf_productid"),p=document.getElementById("wdg_prf_conversiontype");
if(null!==f&&"object"==typeof f&&""!=h.value&&""!=k.value&&""!=p.value){var q=document.createElement("IFRAME");q.setAttribute("src","/wdg/popup_register_feedback-"+f.value+"/tt/conversion.html?campaignID="+h.value+"&productID="+k.value+"&conversionType="+p.value+"&GUID="+b+"&transactionID="+b);q.style.width="1px";q.style.height="1px";document.body.appendChild(q)}}e=m.whichPopupToShow(l,g);c.open(e,d);a.System.emit("popup.header.open")})};h?!0===h&&p():(h="loading",a.Widget.refresh({show_popup_contents:!0},
{callback:function(){setTimeout(function(){h=!0;p()},0)}}))}});e.listen("popup.registration.feedback.closed",function(){a.System.emit("registration.finished");a.System.emit("popup.header.close")})});
